<!DOCTYPE html><!--This file is part of cfillion_Song Switcher.lua--><html><head><meta charset="utf-8" /><meta content="yes" name="apple-mobile-web-app-capable" /><meta content="width=device-width, initial-scale=1" name="viewport" /><title>Song Switcher Control</title><style>html,body,.vlayout{height:100%;margin:0}body{background-color:#000;box-sizing:border-box;color:#fff;font-family:sans-serif;font-size:50px;padding:10px 20px 0 20px;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}div{cursor:default;padding:10px 0 10px 0}.vlayout{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.vlayout>*{-ms-flex-negative:0;flex-shrink:0;margin-bottom:10px}.hlayout{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}.vlayout,.hlayout,#controls,#song_box{padding:0}#song_box{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;word-wrap:break-word;min-width:10px}#song_box span{display:block}#song_box input{background-color:#2e2e2e;border-style:none;color:inherit;display:none;font-size:inherit;text-align:inherit;width:100%}#song_box.edit span{display:none}#song_box.edit input{display:block}#prev,#next{min-width:50px;border:none}.button{border:1px #fff solid;padding:10px}.button:hover:not(.active){background-color:#2e2e2e}.button:active:not(.active){background-color:#3c5a64;color:inherit}#play{font-size:.7em}#play.active{background-color:#7ca5d7;color:#000}#timeline,noscript{height:100px;line-height:100px;width:100%}body:not(.js) #timeline{display:none}#footer{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;font-size:12px}#footer .button{padding:10px 15px 10px 15px;margin-right:10px}#about{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding:0;text-align:right}noscript,.invalid{background-color:red}.hidden{visibility:hidden}a{color:#7ca5d7}@media (max-height: 425px){.spacer{display:none}}@media (max-height: 320px){body{font-size:40px}#timeline{height:80px}}
</style><script src="/main.js"></script></head><body><div class="vlayout"><div class="spacer"><!--Top spacer--></div><div class="hlayout" id="controls"><div class="button" id="prev">&#9664;</div><div id="song_box"><span id="title">## Awaiting data ##</span><input id="filter" spellcheck="false" type="text" /></div><div class="button" id="next">&#9654;</div></div><noscript>Oops! Javascript is blocked or disabled.</noscript><canvas id="timeline"></canvas><div class="button" id="play">Play/Stop</div><div class="hlayout" id="footer"><div class="button" id="panic">MIDI Panic</div><div class="button" id="reset">Reset data</div><div id="about"><a href="http://forum.cockos.com/showthread.php?t=181159" target="_blank">Song Switcher Control</a> by cfillion</div></div></div><script>(function(t){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=t()}else if(typeof define==="function"&&define.amd){define([],t)}else{var e;if(typeof window!=="undefined"){e=window}else if(typeof global!=="undefined"){e=global}else if(typeof self!=="undefined"){e=self}else{e=this}e.SongSwitcherWWW=t()}})(function(){var t,e,i;return function t(e,i,n){function r(o,h){if(!i[o]){if(!e[o]){var u=typeof require=="function"&&require;if(!h&&u)return u(o,!0);if(s)return s(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=i[o]={exports:{}};e[o][0].call(l.exports,function(t){var i=e[o][1][t];return r(i?i:t)},l,l.exports,t,e,i,n)}return i[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,i){var n,r,s,o,h,u,f,l,a,c,p,d,y=function(t,e){for(var i in e){if(m.call(e,i))t[i]=e[i]}function n(){this.constructor=t}n.prototype=e.prototype;t.prototype=new n;t.a=e.prototype;return t},m={}.hasOwnProperty;u="cfillion_song_switcher";f="state";o="relative_move";s="filter";h="reset";n="TRANSPORT;MARKER;GET/EXTSTATE/"+u+"/"+f;l=t(7).EventEmitter;p=t(4);d=function(t){return Math.trunc(parseFloat(t)*1e3)/1e3};c=function(){function t(t){if(t){this.b(t)}else{this.c()}}t.prototype.b=function(t){var e;e=0;this.currentIndex=parseInt(t[e++]);this.songCount=parseInt(t[e++]);this.title=t[e++];this.startTime=d(t[e++]);this.endTime=d(t[e++]);return this.invalid=t[e++]==="true"};t.prototype.c=function(){var t;this.currentIndex=this.songCount=this.startTime=this.endTime=0;return t=["## No data from Song Switcher ##",true],this.title=t[0],this.invalid=t[1],t};return t}();a=function(){function t(t){var e;e=1;this.name=t[e++];this.id=t[e++];this.time=d(t[e++]);this.color=parseInt(t[e++])}return t}();r=function(t){var e;y(i,t);e=function(t,e){return"SET/EXTSTATE/"+u+"/"+t+"/"+encodeURIComponent(e)};function i(t){var e;this.data={};(e=function(i){return function(){i.d("");return setTimeout(e,t)}}(this))()}i.prototype.play=function(){return this.d(40044)};i.prototype.relativeMove=function(t){return this.d(e(o,t))};i.prototype.setFilter=function(t){return this.d(e(s,t))};i.prototype.seek=function(t){return this.d("SET/POS/"+t)};i.prototype.panic=function(){return this.d(40345)};i.prototype.reset=function(){return this.d(e(h,"true"))};i.prototype.d=function(t){var e;e=new XMLHttpRequest;e.onreadystatechange=function(t){return function(){if(e.readyState===XMLHttpRequest.DONE){if(e.status===200){return t.e(e.responseText)}else{return t.f()}}}}(this);e.open("GET","/_/"+t+";"+n,true);return e.send(null)};i.prototype.f=function(){return this.g(function(t){t("playState",false);t("position",0);return t("state",new c)})};i.prototype.e=function(t){var e;e=[];return this.g(function(i){var n,r,s,o,h;o=t.split("\n");for(n=0,s=o.length;n<s;n++){r=o[n];h=r.split("\t");switch(h[0]){case"TRANSPORT":i("playState",h[1]!=="0");i("position",d(h[2]));break;case"MARKER":e.push(new a(h));break;case"EXTSTATE":if(h[1]===u&&h[2]===f){i("state",h[3].length?new c(simple_unescape(h[3]).split("\t")):new c)}}}return i("markerList",e)})};i.prototype.g=function(t){var e,i,n,r,s;r=[];t(function(t){return function(e,i){if(!p(t.data[e],i)){t.data[e]=i;return r.push(e)}}}(this));s=[];for(e=0,n=r.length;e<n;e++){i=r[e];s.push(this.emit(i+"Changed",this.data[i]))}return s};return i}(l);e.exports=r},{4:4,7:7}],2:[function(t,e,i){var n,r,s;n=t(1);s=t(3);r=function(){function t(){this.h=new n(1e3);this.i(document.body,"js");this.j=new s(document.getElementById("timeline"));this.k=document.getElementById("controls");this.l=document.getElementById("prev");this.m=document.getElementById("next");this.n=document.getElementById("play");this.o=document.getElementById("panic");this.p=document.getElementById("reset");this.q=document.getElementById("song_box");this.r=document.getElementById("title");this.s=document.getElementById("filter");this.h.on("playStateChanged",function(t){return function(e){return t.i(t.n,"active",e)}}(this));this.h.on("stateChanged",function(t){return function(e){t.t(t.l,e.currentIndex>1);t.t(t.m,e.currentIndex<e.songCount);t.i(t.k,"invalid",e.invalid);t.u(t.r,e.title||"## No Song Selected ##");return t.j.update(t.h.data)}}(this));this.h.on("positionChanged",function(t){return function(){return t.j.update(t.h.data)}}(this));this.h.on("markerListChanged",function(t){return function(){return t.j.update(t.h.data)}}(this));this.j.on("seek",function(t){return function(e){return t.h.seek(e)}}(this));this.l.addEventListener("click",function(t){return function(){return t.h.relativeMove(-1)}}(this));this.m.addEventListener("click",function(t){return function(){return t.h.relativeMove(1)}}(this));this.n.addEventListener("click",function(t){return function(){return t.h.play()}}(this));this.o.addEventListener("click",function(t){return function(){return t.h.panic()}}(this));this.p.addEventListener("click",function(t){return function(){return t.h.reset()}}(this));this.r.addEventListener("click",function(t){return function(){t.i(t.q,"edit",true);return t.s.focus()}}(this));this.s.addEventListener("blur",function(t){return function(){return t.v()}}(this));this.s.addEventListener("keypress",function(t){return function(e){if(e.keyCode===8&&!t.s.value.length){t.v()}else if(e.keyCode!==13){return}if(t.s.value.length>0){t.h.setFilter(t.s.value)}return t.v()}}(this));window.addEventListener("resize",function(t){return function(){return t.j.update(t.h.data)}}(this));window.addEventListener("keydown",function(t){return function(e){if(e.keyCode===32&&e.target===document.body){return t.h.play()}}}(this))}t.prototype.u=function(t,e){var i;if(i=t.lastChild){return i.nodeValue=e}else{return t.appendChild(document.createTextNode(e))}};t.prototype.i=function(t,e,i){if(i==null){i=true}if(i){return t.classList.add(e)}else{return t.classList.remove(e)}};t.prototype.t=function(t,e){return this.i(t,"hidden",!e)};t.prototype.v=function(){this.i(this.q,"edit",false);this.s.value="";return document.activeElement.blur()};return t}();e.exports=r},{1:1,3:3}],3:[function(t,e,i){var n,r,s,o,h,u,f,l,a,c,p,d,y,m,v,g,w,T,E,b,Q=function(t,e){for(var i in e){if(z.call(e,i))t[i]=e[i]}function n(){this.constructor=t}n.prototype=e.prototype;t.prototype=new n;t.a=e.prototype;return t},z={}.hasOwnProperty;m="#2e2e2e";g="black";f=15;u="sans-serif";n=1;r=-1;y=20;s="yellow";o=3;l="#888888";a=1;p="white";c="red";d=2;w=1;T=2;E=3;v=50;h=t(7).EventEmitter;b=function(t){Q(e,t);function e(t){this.w=t;this.x=[];this.y=f;this.z=this.w.getContext("2d");this.w.addEventListener("click",function(t){return function(e){return t.A(e.offsetX)}}(this))}e.prototype.update=function(t){var e,i,s,o,h;this.B=t;this.x.length=0;this.C();this.z.textBaseline="hanging";this.z.fillStyle=m;this.z.fillRect(0,this.y,this.w.width,this.D);this.F(0);this.F(this.B.state.endTime-this.B.state.startTime);o=[c,c],this.z.strokeStyle=o[0],this.z.fillStyle=o[1];h=this.B.markerList;for(e=0,i=h.length;e<i;e++){s=h[e];if(s.time>=this.B.state.startTime&&s.time<=this.B.state.endTime){this.G(s)}}this.H(this.B.position-this.B.state.startTime);if(this.B.position<this.B.state.startTime){this.I(n)}else if(this.B.position>this.B.state.endTime){this.I(r)}return this.x.sort(function(t,e){return t-e})};e.prototype.C=function(){var t;t=[this.w.clientWidth,this.w.clientHeight],this.w.width=t[0],this.w.height=t[1];this.D=this.w.height-this.y*2;this.J=this.y+this.D;this.K=(this.B.state.endTime-this.B.state.startTime)/this.w.width;return this.K||(this.K=1/Math.pow(2,32))};e.prototype.H=function(t){var e;e=this.L(t);this.z.strokeStyle=this.z.fillStyle=s;this.z.lineWidth=o;this.z.beginPath();this.z.moveTo(e-this.y,0);this.z.lineTo(e,this.y+o);this.z.lineTo(e+this.y,0);this.z.fill();return this.M(t,false)};e.prototype.F=function(t){this.z.strokeStyle=this.z.fillStyle=l;this.z.lineWidth=a;return this.M(t)};e.prototype.G=function(t){var e,i,n,r;r=t.time-this.B.state.startTime;n=this.L(r);e=n-d*2;this.z.fillStyle=m;this.z.fillRect(e,this.y,this.w.width-n,this.D);this.z.strokeStyle=this.z.fillStyle=c;this.z.lineWidth=d;this.M(r);if(t.name.length>0){this.z.font="bold "+f+"px "+u;i=this.z.measureText(t.name).width+d*2;this.z.fillRect(n,this.y,i,f);this.z.fillStyle=p;return this.z.fillText(t.name,n+d,this.y+2)}};e.prototype.M=function(t,e){var i,n,r,s,o,h,l,a;if(e==null){e=true}h=this.L(t);s=e?0:this.J+3;if(e){this.x.push(h)}this.z.beginPath();this.z.moveTo(h,this.y);this.z.lineTo(h,this.J);this.z.stroke();this.z.font=f+"px "+u;l=[this.z.fillStyle,g],o=l[0],this.z.fillStyle=l[1];i=this.N(t,!e);a=this.O(h,i,!e),r=a[0],n=a[1];this.z.fillRect(r,s,n,f);this.z.fillStyle=o;return this.z.fillText(i,r,s+1)};e.prototype.O=function(t,e,i){var n,r;r=this.z.measureText(e).width;if(i){t-=r/2}if((n=t+r)>this.w.width){t-=n-this.w.width}t=Math.max(0,t);return[t,r]};e.prototype.I=function(t){var e,i,n,s;i=y;if(t===r){i=this.w.width-i}e=this.D/2.5;s=e;n=(this.w.height-e)/2;this.z.lineWidth=3;this.z.beginPath();this.z.moveTo(i+s*t,n);this.z.lineTo(i,n+e/2);this.z.lineTo(i+s*t,n+e);return this.z.stroke()};e.prototype.L=function(t){return t/this.K};e.prototype.P=function(t){return t*this.K};e.prototype.N=function(t,e){var i,n,r,s,o,h;h=t<0?"-":"";i=Math.abs(t/60);o=Math.abs(t%60);n=Math.abs(t*1e3);s=function(t,e){e=Math.trunc(e);return(t+e).slice(-t.length)};r=""+h+s("00",i)+":"+s("00",o);if(e){r+="."+s("000",n)}return r};e.prototype.A=function(t){var e,i,n,r,s,o;o=[-1,this.x.length],r=o[0],n=o[1];while(n-r>1){i=Math.round((r+n)/2);s=this.x[i];if(s<=t){r=i}else{n=i}}r=this.x[r]-t;n=this.x[n]-t;e=Math.min(Math.abs(r),Math.abs(n));if(e<v){t=(e===Math.abs(r)?r:n)+t}return this.emit("seek",this.P(t)+this.B.state.startTime)};return e}(h);e.exports=b},{7:7}],4:[function(t,e,i){var n=Array.prototype.slice;var r=t(6);var s=t(5);var o=e.exports=function(t,e,i){if(!i)i={};if(t===e){return true}else if(t instanceof Date&&e instanceof Date){return t.getTime()===e.getTime()}else if(!t||!e||typeof t!="object"&&typeof e!="object"){return i.strict?t===e:t==e}else{return f(t,e,i)}};function h(t){return t===null||t===undefined}function u(t){if(!t||typeof t!=="object"||typeof t.length!=="number")return false;if(typeof t.copy!=="function"||typeof t.slice!=="function"){return false}if(t.length>0&&typeof t[0]!=="number")return false;return true}function f(t,e,i){var f,l;if(h(t)||h(e))return false;if(t.prototype!==e.prototype)return false;if(s(t)){if(!s(e)){return false}t=n.call(t);e=n.call(e);return o(t,e,i)}if(u(t)){if(!u(e)){return false}if(t.length!==e.length)return false;for(f=0;f<t.length;f++){if(t[f]!==e[f])return false}return true}try{var a=r(t),c=r(e)}catch(t){return false}if(a.length!=c.length)return false;a.sort();c.sort();for(f=a.length-1;f>=0;f--){if(a[f]!=c[f])return false}for(f=a.length-1;f>=0;f--){l=a[f];if(!o(t[l],e[l],i))return false}return typeof t===typeof e}},{5:5,6:6}],5:[function(t,e,i){var n=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";i=e.exports=n?r:s;i.supported=r;function r(t){return Object.prototype.toString.call(t)=="[object Arguments]"}i.unsupported=s;function s(t){return t&&typeof t=="object"&&typeof t.length=="number"&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||false}},{}],6:[function(t,e,i){i=e.exports=typeof Object.keys==="function"?Object.keys:n;i.shim=n;function n(t){var e=[];for(var i in t)e.push(i);return e}},{}],7:[function(t,e,i){function n(){this.Q=this.Q||{};this.R=this.R||undefined}e.exports=n;n.EventEmitter=n;n.prototype.Q=undefined;n.prototype.R=undefined;n.defaultMaxListeners=10;n.prototype.setMaxListeners=function(t){if(!s(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");this.R=t;return this};n.prototype.emit=function(t){var e,i,n,s,u,f;if(!this.Q)this.Q={};if(t==="error"){if(!this.Q.error||o(this.Q.error)&&!this.Q.error.length){e=arguments[1];if(e instanceof Error){throw e}else{var l=new Error('Uncaught, unspecified "error" event. ('+e+")");l.context=e;throw l}}}i=this.Q[t];if(h(i))return false;if(r(i)){switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1);i.apply(this,s)}}else if(o(i)){s=Array.prototype.slice.call(arguments,1);f=i.slice();n=f.length;for(u=0;u<n;u++)f[u].apply(this,s)}return true};n.prototype.addListener=function(t,e){var i;if(!r(e))throw TypeError("listener must be a function");if(!this.Q)this.Q={};if(this.Q.newListener)this.emit("newListener",t,r(e.listener)?e.listener:e);if(!this.Q[t])this.Q[t]=e;else if(o(this.Q[t]))this.Q[t].push(e);else this.Q[t]=[this.Q[t],e];if(o(this.Q[t])&&!this.Q[t].warned){if(!h(this.R)){i=this.R}else{i=n.defaultMaxListeners}if(i&&i>0&&this.Q[t].length>i){this.Q[t].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this.Q[t].length);if(typeof console.trace==="function"){console.trace()}}}return this};n.prototype.on=n.prototype.addListener;n.prototype.once=function(t,e){if(!r(e))throw TypeError("listener must be a function");var i=false;function n(){this.removeListener(t,n);if(!i){i=true;e.apply(this,arguments)}}n.listener=e;this.on(t,n);return this};n.prototype.removeListener=function(t,e){var i,n,s,h;if(!r(e))throw TypeError("listener must be a function");if(!this.Q||!this.Q[t])return this;i=this.Q[t];s=i.length;n=-1;if(i===e||r(i.listener)&&i.listener===e){delete this.Q[t];if(this.Q.removeListener)this.emit("removeListener",t,e)}else if(o(i)){for(h=s;h-- >0;){if(i[h]===e||i[h].listener&&i[h].listener===e){n=h;break}}if(n<0)return this;if(i.length===1){i.length=0;delete this.Q[t]}else{i.splice(n,1)}if(this.Q.removeListener)this.emit("removeListener",t,e)}return this};n.prototype.removeAllListeners=function(t){var e,i;if(!this.Q)return this;if(!this.Q.removeListener){if(arguments.length===0)this.Q={};else if(this.Q[t])delete this.Q[t];return this}if(arguments.length===0){for(e in this.Q){if(e==="removeListener")continue;this.removeAllListeners(e)}this.removeAllListeners("removeListener");this.Q={};return this}i=this.Q[t];if(r(i)){this.removeListener(t,i)}else if(i){while(i.length)this.removeListener(t,i[i.length-1])}delete this.Q[t];return this};n.prototype.listeners=function(t){var e;if(!this.Q||!this.Q[t])e=[];else if(r(this.Q[t]))e=[this.Q[t]];else e=this.Q[t].slice();return e};n.prototype.listenerCount=function(t){if(this.Q){var e=this.Q[t];if(r(e))return 1;else if(e)return e.length}return 0};n.listenerCount=function(t,e){return t.listenerCount(e)};function r(t){return typeof t==="function"}function s(t){return typeof t==="number"}function o(t){return typeof t==="object"&&t!==null}function h(t){return t===void 0}},{}]},{},[2])(2)});new SongSwitcherWWW()</script></body></html>
